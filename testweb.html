<head>
	<meta charset="utf-8"/>
	<script type="text/javascript" src="./libgif.js"></script>
	<!--<script type="text/javascript" src="./test.js"></script>-->
	<link rel="stylesheet" type="text/css" href="default.css" media="screen" />
</head>
<body>
test
<div id="cont">
	<img id="background"  class="image" src="images/1.gif"/>
</div>
<script>
makeGif();

function makeGif() {
	var framesCount = [5,5,6,8,10];
	var index = Math.round(Math.random()*4)+1;
	var imgurl = "images/" + index.toString() + ".gif";

	imgref = document.getElementById("background");
	imgref.src = imgurl;
	var bg = new SuperGif({ gif: imgref, progressbar_height: 0 } );
	var frames = framesCount[index-1];
	var bpm = Number(window.location.search.substring(1));
	if(isNaN(bpm)){
		bpm = 120;
	}
	var delay = (60/bpm)*(1000/frames);
	bg.load(function() {
        	bg.pause();
		var loopGif = window.setInterval(changeGif,delay);
	});
	var canvas = bg.get_canvas();
	canvas.setAttribute("id","background");

	function changeGif() {
		bg.move_relative(1);
	}
}
document.onkeypress = function (e) {
        e = e || window.event;
        bg.move_relative(1);
        if (e == 37) {
                bg.move_relative(-1);
        }
        else if (e == 39) {
                bg.move_relative(1);
        }
}
</script>
</body>
